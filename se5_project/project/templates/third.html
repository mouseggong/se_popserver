{% extends 'common.html' %}

{% block content %}
  <script>
    $(window).ready(function(){
      //$(document).ready(function()
      //document를 파라미터로 넘기면, 
      //태그등이 셋팅이 완료되었을때의 시점에 이벤트를 
      //발생 
      //$(window).ready(function()
      //모든 리소스, 즉 이미지 플래시, 등등 문서에 포함되는 
      //모든 소스가 로딩이 완료되는 시점에 이벤트를 발생시킨다.
      get_news_list(function(data){
        //data배열 !
        $.each(data,function(key,value){
          //each함수는 배열과 객체를 순회할 목적으로 쓰인다.
          //배열내 모든 요소에서 function을 수행하고
          //key에 배열에 인덱스를 전달, value에는 배열에 데이터가 전달됨.
          console.log(key);
          console.log(value);
          var item = '<div class="item">';
          item+='<img src="https://search.pstatic.net/common/?src=http%3A%2F%2Fncc.phinf.naver.net%2F20160413_119%2F14605088779818khzN_JPEG%2F113030.jpg&type=f80_80_re24" class="image">';
          //item+=value.image; 왜 안해도 되는지.
          item+='<div class="body">';
          item+='<div class="head">';
          item+='<a href="" class="title">'; //원본 뉴스 URL넣기
          item+=value.title;
          item+='</a>';
          item+='<p class="date">';
          item+=value.date;
          item+='</p>';
          item+='</div>';
          item+='<div class="content">';
          item+=value.body;
          item+='</div>';
          item+='<div class="tail">';
          item+=value.reporter;
          item+='</div>';
          item+='</div>';
          item+='</div>';
          // console.log(item);
          $("#news_list").append(item); //news_list클래스에 추가
        });
      });
    });
    
  </script>

<style type="text/css">
	
	.fixed-panel{
		min-height:30px;
		max-height:500px;
		overflow-y:scroll;
	}

</style>


<style>
	
	body {
		font-family:"Lucida Grande","Droid Sans",Arial,Helvetica,sans-serif;
		background: #eee;
	}
	
	.legend {
		border: 1px solid #555555;
		border-radius: 5px 5px 5px 5px;
		font-size: 0.8em;
		margin: 10px;
		padding: 8px;
	}
	
	.bld {
		font-weight: bold;
	}
	

	#display{
		height: 500px;
		width:500px;
		border: 8px solid black;
		overflow: auto;
	}

</style>



<body>

	<nav class = "navbar navbar-inverse">
		<div class = "container-fluid">
			<div class = "navbar-header">
				<a class="navbar-brand" href="#"><img src="{{common.host}}/static/images/pop1.jpg" width="100" height="40"></a>
			</div>
		</div>
		<form class="form-inline">
			<input type="text" class="form-control" size="50" placeholder="{{keyword}}" required>
			<button type="button" class="btn btn-danger">Search</button>
		</form>
	</nav>



	<div class="row">
		<div class="col-sm-6">
			<h3> Searched NewsList</h3>
			<div class="panel panel-default">
				<div class="panel-heading">Searched NewsList</div>
				<div class="panel-body fixed-panel">
					<div class="news_list">
						
					</div>
				</div>
			</div>
		</div>
		
		
		<div class="col-sm-6">
			<h3>Word-Cloud</h3>     
			<div class="panel panel-default">
				<div class="panel-heading">The WordCloud</div>
				<div class="panel-body fixed-panel">
					<svg width="1000" height="500"></svg>

					<script>

						var margin = {top: 2, right: 2, bottom: 4, left: 2},
						width = 1000 - margin.left - margin.right,
						height = 500 - margin.top - margin.bottom;

						d3.csv("data.csv", function(error, data) {

							var categories = d3.keys(d3.nest().key(function(d) { return d.category; }).map(data));
							var color = d3.scale.ordinal().range(["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"]);
							var fontSize = d3.scale.pow().exponent(5).domain([0,1]).range([10,80]);

							var layout = d3.layout.cloud()
							.timeInterval(10)
							.size([width, height])
							.words(data)
							.rotate(function(d) { return 0; })
							.font('monospace')
							.fontSize(function(d,i) { return fontSize(Math.random()); })
							.text(function(d) { return d.password; })
							.spiral("archimedean")
							.on("end", draw)
							.start();

							var svg = d3.select('svg').append("svg")
							.attr("width", width + margin.left + margin.right)
							.attr("height", height + margin.top + margin.bottom)
							.append("g")
							.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

							var wordcloud = svg.append("g")
							.attr('class','wordcloud')
							.attr("transform", "translate(" + width/2 + "," + height/2 + ")");

 // var x0 = d3.scale.ordinal()
   //   .rangeRoundBands([0, width], .1)
     // .domain(categories);

 // var xAxis = d3.svg.axis()
   //   .scale(x0)
     // .orient("bottom");

     svg.append("g")
     .attr("class", "x axis")
     .attr("transform", "translate(0," + height + ")")
     .call(xAxis)
     .selectAll('text')
     .style('font-size','20px')
     .style('fill',function(d) { return color(d); })
     .style('font','sans-serif');

     function draw(words) {
     	wordcloud.selectAll("text")
     	.data(words)
     	.enter().append("text")
     	.attr('class','word')
     	.style("font-size", function(d) { return d.size + "px"; })
     	.style("font-family", function(d) { return d.font; })
     	.style("fill", function(d) { 
     		var paringObject = data.filter(function(obj) { return obj.password === d.text});
     		return color(paringObject[0].category); 
     	})
     	.attr("text-anchor", "middle")
     	.attr("transform", function(d) { return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")"; })
     	.text(function(d) { return d.text; });
     };

 });

</script>
</div>
</div>

</div> <!-- div col -->
</div> <!-- div row -->



<div class="panel panel-default">
	<div class="container text-center">
		<h3>THE POP</h3>
		<p><em>Present of Present!</em></p>
		<p>We created a website of Searching the trend of nowdays</p>
		<br>
		<div class="row">
			<div class="col-sm-3">
				<p><strong>Lee HyungRae</strong></p><br>
				<img src="{{common.host}}/static/images/wonbin.jpg" alt="Random Name">
			</div>
			<div class="col-sm-3">
				<p><strong>Oh JongHun</strong></p><br>
				<img src="{{common.host}}/static/images/wonbin.jpg" alt="Random Name">
			</div>
			<div class="col-sm-3">
				<p><strong>Min Jaehyun</strong></p><br>
				<img src="{{common.host}}/static/images/wonbin.jpg" alt="Random Name">
			</div>
			<div class="col-sm-3">
				<p><strong>Mun HoChan</strong></p><br>
				<img src="{{common.host}}/static/images/wonbin.jpg" alt="Random Name">
			</div>
		</div>
	</div>
</div>


</body>

{% endblock content %}